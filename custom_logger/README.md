# custom_logger

A brick to create your custom logger with different levels.

## How to use ðŸš€

```
mason make custom_logger --logger_name custom
```

## Variables âœ¨

| Variable         | Description                      | Default | Type      |
| ---------------- | -------------------------------- | ------- | --------- |
| `logger_name`    | The name of the logger           | custom  | `string`  |

## Outputs ðŸ“¦

```
--logger_name custom 
â”€â”€ logger
  â”œâ”€â”€ custom_logger.dart
  â””â”€â”€ log_level.dart
```

```dart
import 'dart:developer' as dev show log;

import 'package:firebase_crashlytics/firebase_crashlytics.dart';
import 'package:flutter/foundation.dart';
import 'package:logger_app/core/logger/contract/custom_contract.dart';
import 'package:logger_app/core/logger/log_levels/log_level.dart';

/// [CustomLogger] is a custom logger that can be used
/// to report errors to another service like Crashlytics
class CustomLogger implements CustomLoggerContract {
  /// [CustomLogger] constructor
  /// (here we initialize Firebase Crashlytics)
  CustomLogger({
    FirebaseCrashlytics? crashlytics,
  }) : _crashlytics = crashlytics ?? FirebaseCrashlytics.instance;

  /// Complete the final steps in order report errors without any problems
  /// on Android/IOS in https://firebase.google.com/docs/crashlytics/get-started?platform=flutter
  final FirebaseCrashlytics _crashlytics;

  @override
  void debug(String message) {
    _log(message, level: LogLevel.debug);
  }

  @override
  void info(String message) {
    _log(message);
  }

  @override
  void warning(String message) {
    _log(message, level: LogLevel.warning);
  }

  @override
  void error(String message) {
    _log(message, level: LogLevel.error);

    /// Collect the Crashlytics logs and send to server immediately, only
    /// for high serverity logs
    _throwAndReportError(message);
  }

  @override
  void critical(
    String message,
  ) {
    _log(message, level: LogLevel.critical);

    /// Collect the Crashlytics logs and send to server immediately, only
    /// for high serverity logs
    _throwAndReportError(message);
  }

  @override
  void exception(
    Object error,
    StackTrace stackTrace, {
    Object? reason,
    bool fatal = true,
  }) {
    _log('The following exception occurred: $error', level: LogLevel.critical);

    /// Avoid report while in debug mode
    if (kDebugMode) return;

    _crashlytics.recordError(
      error,
      stackTrace,
      reason: reason,
      fatal: fatal,
    );
  }

  void _log(String message, {LogLevel level = LogLevel.info}) {
    final currentTime = DateTime.now();
    dev.log(
      message,
      level: level.value,
      time: currentTime,
    );

    /// Avoid send log to an external service while in debug
    if (kDebugMode) return;
    _crashlytics.log('${level.name}(level): $message');
  }

  /// Simulate a "crash" so that we can collect the stack trace and report to
  /// crashlytics
  void _throwAndReportError(String message) {
    try {
      throw Exception(message);
    } catch (error, stackTrace) {
      /// Avoid report while in debug mode
      if (kDebugMode) return;

      _crashlytics.recordError(
        error,
        stackTrace,
        reason: message,
        fatal: true,
      );
    }
  }
}
```

[![Powered by Mason](https://img.shields.io/endpoint?url=https%3A%2F%2Ftinyurl.com%2Fmason-badge)](https://github.com/felangel/mason)

A new brick created with the Mason CLI.

_Generated by [mason][1] ðŸ§±_

## Getting Started ðŸš€

This is a starting point for a new brick.
A few resources to get you started if this is your first brick template:

- [Official Mason Documentation][2]
- [Code generation with Mason Blog][3]
- [Very Good Livestream: Felix Angelov Demos Mason][4]

[1]: https://github.com/felangel/mason
[2]: https://github.com/felangel/mason/tree/master/packages/mason_cli#readme
[3]: https://verygood.ventures/blog/code-generation-with-mason
[4]: https://youtu.be/G4PTjA6tpTU
